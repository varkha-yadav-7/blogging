<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Blogging</title>
        {% load static %}
        <script src="{% static 'home/base.js' %}"></script>
        <link rel="stylesheet" type="text/css" href="{% static 'home/blogging.css' %}">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    </head>
    <body style="background-color: rgb(201, 198, 197); text-align: center;">
      <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>    
        <nav class="navbar navbar-dark" style="background-color: black;">
          {% load mytags %}
            {% if request.session.name %}
                <div id="main">
                    <button class="openbtn" onclick="openNav()">☰</button>
                </div>
            {% else %}
                <span class="navbar-brand">Blogging</span>
            {% endif %}
            <ul class="row justify-content-end">
            <li><a href="/" class="navbar-brand">Home</a></li>
            {% if request.session.name %}
            <div class="dropdown">
            <a onclick="notif()" class="navbar-brand" role="button" id="mydrop" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#">Notifications<span id="nbadge" class="badge badge-danger">{% totalNotifications request.session.username %}</span></a>
            <div style="width: 300px;" class="dropdown-menu" aria-labelledby="mydrop">
              <div class="dropdown-header" style="color: blue;">Marked as Read Now</div>
              <div id="notifylist">

              </div>
            </div>
            </div>
            <li><a href="/logout/" class="navbar-brand">Logout of {{request.session.name}}</a></li>
            {% else %}
            <li><a href="/signup/" class="navbar-brand">Sign up</a></li>
            <li><a href="/login/" class="navbar-brand">Login</a></li>
            <li><a href="/myadmin/" class="navbar-brand">Admin</a></li>
            {% endif %}
            </ul>
        </nav>
            <div id="mySidebar" class="sidebar">
                <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
                <img height="100px" width="100px" style="max-width: 100%; height: auto;" class="imag-thumbnail img-responsive" src="{{ request.session.dp }}">
                <a style="text-align: center; color:white;">{{request.session.username}}</a><br>
                <a href="/viewprofile/">Profile</a>
                <a href="/addpost/">Add Post</a>
                <a href="/viewposts/">Your Posts</a>
                <a href="/bookmarks/">Bookmarks</a>
            </div>
            <br>
          {% block bodyhere %}
          <h1>Blogging</h1><br>
          {% for i in post %}
            <div style="border: thick solid black; padding: 5px; margin-left: 200px; margin-right: 200px;">
                <h3>Post by {{ i.Username }}</h3>
                <img height="500px" width="500px" style="max-width: 100%; height: auto;" class="imag-thumbnail img-responsive" src="{{ i.Image.url }}">
                <h4>{{ i.caption }}</h4>
                {%csrf_token%}
                <a onclick="showLikes({{i.id}})" href="#LikesModal" data-toggle="modal" id="totalL{{i.id}}" style="padding-right: 40px;">Likes : {% totalLikes i.id %}</a>
                <a onclick="showComments({{i.id}})" href="#CommentsModal" data-toggle="modal" id="totalC{{i.id}}">Comments : {% totalComments i.id %}</a>
                {% if request.session.username %}
                {%csrf_token%}
                <div style="padding: 10px;" class="content-block">
                <button style="margin-right: 40px;" onclick="liked({{i.id}})" id="like{{i.id}}">{% getLikes i.id likes %}</button>
                <button onclick="bookmarked({{i.id}})" id="book{{i.id}}">{% getBookmarks i.id book %}</button>
                </div>
                <form action="/commenting/" method="POST">{% csrf_token %}
                    <input type="text" name="comment" placeholder="Type a comment"> 
                <button onclick="comments({{i.id}})" id="comment{{i.id}}" value="{{i.id}}" name="pid">Comment</button>
                </form>
                {% else %}
                <form action="/login/" method="POST">{% csrf_token %}
                  <div style="padding: 10px;" class="content-block">
                    <button style="margin-right: 40px;">Like</button>
                    <button>Bookmark</button>
                  </div>
                    <input type="text" placeholder="Type a comment"> 
                    <button>Comment</button><br>
                </form>
                {% endif %}
            </div><br>
            {% endfor %}
            <div class="modal fade" id="LikesModal" role="dialog">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">People who liked this post</h5>
                    </div>
                    <div style="text-align: left;" id="likers" class="modal-body">
                        
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>  
            </div>
            <div class="modal fade" id="CommentsModal" role="dialog">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">People who commented on this post</h5>
                    </div>
                    <div style="text-align: left;" id="commenters" class="modal-body">
                        
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>  
            </div>
          {% endblock %}
    </body>
</html>